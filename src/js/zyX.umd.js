/*! For license information please see zyX.umd.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.zyX=e():t.zyX=e()}(self,()=>(()=>{"use strict";var t={d:(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{AsynConstructor:()=>nt,AsyncWorker:()=>st,Cookies:()=>tt,Deque:()=>w,FocusController:()=>Rt,Focusable:()=>Dt,LegacyAsynConstructor:()=>it,LiveDeque:()=>E,LiveDomList:()=>S,LiveList:()=>k,LiveVar:()=>T,ScrollTo:()=>bs,WeakRefSet:()=>b,ZyXAudio:()=>Pt,ZyXEvents:()=>ft,ZyXHTML:()=>R,ZyXIO:()=>gs,ZyXInput:()=>ne,addEventListeners:()=>mt,asyncPool:()=>ot,breakDelayChain:()=>ht,calculateDominantColor:()=>_s,clamp:()=>gt,clearAllSelections:()=>u,clearDelay:()=>ut,css:()=>G,dataToBlob:()=>K,debounce:()=>pt,default:()=>Ls,delay:()=>lt,delayChain:()=>ct,deleteData:()=>$,displayAnimation:()=>vs,fetchCSS:()=>j,fetchJSON:()=>H,fetchWithTimeout:()=>Z,forEachShadowRoot:()=>l,forQuery:()=>Bt,getAllShadowRoots:()=>h,getData:()=>I,getTopLevelElements:()=>r,grabBlob:()=>q,hexToHSL:()=>zt,hexToRGB:()=>qt,hslCssKeys:()=>jt,hslToHex:()=>Yt,html:()=>N,injectScript:()=>W,insertAfter:()=>a,instant:()=>dt,isEven:()=>_t,isFloat:()=>Lt,isInteger:()=>St,isMobile:()=>Ms,isOdd:()=>Mt,lerp:()=>vt,loadImg:()=>z,makePlaceable:()=>D,mapRange:()=>bt,placeSafely:()=>Ft,pointerEventPathContains:()=>It,pointerEventPathContainsMatching:()=>Xt,postData:()=>F,postForm:()=>X,putData:()=>V,queryAllRoots:()=>d,randomFloat:()=>At,randomInt:()=>xt,removeEventListeners:()=>yt,roundTo:()=>Et,roundToDecimals:()=>Tt,sS:()=>Ut,scaleFromOffset:()=>wt,scaleToOffset:()=>kt,seedRandom:()=>Vt,seedShuffle:()=>Ht,setProps:()=>Nt,shorthandNumber:()=>$t,shrinkImage:()=>Y,sleep:()=>et,splitFilename:()=>U,zyxcss:()=>Q});var s={};t.r(s),t.d(s,{click:()=>Zt,clickOne:()=>Kt,clickOrTwo:()=>Jt,hrefDoubleClick:()=>te,pointerDownMoveUp:()=>Qt,rightClick:()=>Wt,wheel:()=>Gt});const n="zyx-ph";function i(t){return`<${n} id='${t}'></${n}>`}function o(t){const e=t.match(/id='(.*?)'/);return e?.length>0?e[1]:null}function r(t){const e=document.createElement("div");return e.innerHTML=t.trim(),Array.from(e.children)}function a(t,e){e.parentNode.insertBefore(t,e.nextSibling)}new RegExp(`(${i("\\d+")})`,"g");class c{constructor(t,e,s){this.reactive=t,this.interp=e,this.mode=s||"text",this.activeDomNode=null}interprate(){return this.interp?this.interp(this.reactive.value):this.reactive.value}createZyXHTMLReactiveNode(t,e,s){let n,i;if(s)n=()=>{const t=this.interprate();e.setAttribute(s,t),"INPUT"===e.tagName&&(e.value=t,e.dispatchEvent(new Event("change")))},i=e,setTimeout(()=>n(),0);else{if("text"===this.mode){const t=document.createTextNode("");e.replaceWith(t),i=t,n=()=>{const e=this.interprate();t.textContent=e}}else"html"===this.mode&&(this.activeDomNode=e,i=e.parentElement,n=()=>{const t=D(this.interprate());t?(this.activeDomNode.replaceWith(t),this.activeDomNode=t):this.activeDomNode.style.display="none"});n()}this.reactive.eventListeners?this.reactive.eventListeners.subscribe(n,i):this.reactive.subscribe(n,i)}}function h(){return[...document.querySelectorAll("[zyx-shadowroot-processed]")].map(t=>t.shadow).filter(Boolean)}function l(t){h().forEach(t)}function u(){l(t=>{t.getSelection&&t.getSelection().removeAllRanges()}),document.getSelection&&document.getSelection().removeAllRanges()}function d(t){const e=[];return l(s=>{e.push(...s.querySelectorAll(t))}),e.push(...document.querySelectorAll(t)),e}const p=Object.fromEntries(["click","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout","mouseenter","contextmenu","mouseleave","keydown","keypress","keyup","focus","blur","submit","load","error","input","change","scroll","resize","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","dropzone","dropzoneenter","dropzoneleave","dropzoneover","dropzoneout","dropzoneenter","dropzoneleave"].map(t=>[`zyx-${t}`,({node:e,data:s,zyxhtml:n})=>{try{const i=t=>{const i=new Proxy(t,{get:(s,i)=>"el"===i?e:"e"===i||"event"===i?t:i in n?n[i]:void 0});return s(i)};e.addEventListener(t,i)}catch(i){console.error(`Error adding event listener for [zyx-${t}]:`,{e:i,node:e,data:s,zyxhtml:n})}}]));p["zyx-enter"]=({node:t,data:e,zyxhtml:s})=>{t.addEventListener("keydown",t=>{"Enter"===t.key&&e(new Proxy(t,{get:(e,n)=>"e"===n||"event"===n?t:n in s?s[n]:void 0}))})};const f=new WeakMap;class m{#t=[];#e=null;constructor(t){f.set(t,this)}addCondition(t,e){this.#t.push({element:t,condition:e}),t.style.display="none",e.reactive&&"object"==typeof e.reactive&&"subscribe"in e.reactive&&e.reactive.subscribe(()=>this.evaluateConditions(),t),this.evaluateConditions()}evaluateConditions(){let t=!1,e=null;this.#e&&(this.#e.style.display="none",this.#e=null);for(const{element:t}of this.#t)t.style.display="none";for(const{element:s,condition:n}of this.#t){if(n.isElse){e=s;continue}const i=n.reactive.value;(n.predicate?n.predicate(i):i)&&!t&&(s.style.display="",this.#e=s,t=!0)}!t&&e&&(e.style.display="",this.#e=e)}}function y(t){let e=f.get(t);return e||(e=new m(t)),e}function g(t){const e=function(t){let e=t.previousElementSibling;for(;e;){if(e.hasAttribute("zyx-if"))return e;e=e.previousElementSibling}return null}(t);return e?y(e):(console.warn("zyx-elif or zyx-else found without a preceding zyx-if:",t),null)}const v={"zyx-if":function({node:t,data:e,zyxhtml:s}){const n=y(t),[i,o]=Array.isArray(e)?e:[e,null];n.addCondition(t,{reactive:i,predicate:o})},"zyx-elif":function({node:t,data:e,zyxhtml:s}){const n=g(t);if(!n)return;const[i,o]=Array.isArray(e)?e:[e,null];n.addCondition(t,{reactive:i,predicate:o})},"zyx-else":function({node:t,data:e,zyxhtml:s}){const n=g(t);n&&n.addCondition(t,{isElse:!0})}};new WeakMap;class b extends Set{add(t){if(null==t)throw new TypeError("Cannot add null or undefined to WeakRefSet");this.has(t)||super.add(new WeakRef(t))}forEach(t){if("function"!=typeof t)throw new TypeError("Callback must be a function");for(const e of this.get())t(e)}delete(t){if(null==t)return!1;for(const e of super.values())if(e.deref()===t)return super.delete(e);return!1}singleize(t){if(null==t)throw new TypeError("Cannot singleize with null or undefined reference");for(const e of super.values())e.deref()!==t&&super.delete(e)}get(){const t=[];for(const e of super.values()){const s=e.deref();void 0===s?super.delete(e):t.push(s)}return t}get size(){return this.get().length}}class w extends Array{constructor(t){if("number"!=typeof t||t<0)throw new TypeError("Limit must be a non-negative number");super(),this.limit=t}prepend(t){return this.length>=this.limit&&this.pop(),this.unshift(t),this}append(t){return this.length>=this.limit&&this.shift(),this.push(t),this}popleft(){if(0===this.length)throw new Error("Deque is empty");return this.shift()}popright(){if(0===this.length)throw new Error("Deque is empty");return this.pop()}isEmpty(){return 0===this.length}isFull(){return this.length>=this.limit}}class k extends Array{#s;constructor(t){t instanceof Array?super(...t):super(),this.#s=new A}fill(t,e){for(let s=0;s<t;s++)super.push(e(s));return this.callListeners("fill"),this}interp(t){return new c(this,t)}contentInterp(t){return new c(this,t,"html")}get value(){return this}subscribe(t,e){this.#s.subscribe(t,e)}removeListener(t){this.#s.unsubscribe(t)}callListeners(t,...e){return this.#s.notifySubscribers(this,t,...e),this}push(...t){return super.push(...t),this.callListeners("push",...t),this}pop(){const t=super.pop();return this.callListeners("pop",t),t}shift(){const t=super.shift();return this.callListeners("shift",t),t}unshift(...t){return super.unshift(...t),this.callListeners("unshift",...t),this}splice(t,e,...s){const n=super.splice(t,e,...s);return this.callListeners("splice",t,e,...s),n}update(){return this.callListeners("update"),this}clear(){return super.splice(0,this.length),this.callListeners("clear"),this}remove(t){const e=this.indexOf(t);return-1!==e&&this.splice(e,1),this}sort(t){return super.sort(t),this.callListeners("sort",t),this}swap(t){if(!Array.isArray(t))throw new TypeError("LiveList.swap() requires an array");return this.clear(),this.push(...t),this}insert(t,...e){return this.splice(t,0,...e),this}}class E extends w{constructor(t){super(t)}}class T{constructor(t){this.initialValue=t,this.value=t,this.eventListeners=new A}interp(t){return new c(this,t,"text")}contentInterp(t){return new c(this,t,"html")}subscribe(t,e){this.eventListeners.subscribe(t,e)}reset(){this.value=this.initialValue,this.eventListeners.notifySubscribers(this.value)}toggle(){const t=this.get();if("boolean"!=typeof t)throw new TypeError("LiveVar.toggle() only works for Booleans");return this.set(!t),this}set(t){t!==this.value&&(this.value=t,this.eventListeners.notifySubscribers(this.value))}default(t,e){return void 0!==this.value&&null!==this.value&&this.value!==t||this.set(e),this}get(){return this.value}}const x=new WeakMap;class A{constructor(){this.subscribers=new b}subscribe(t,e){if("function"!=typeof t)throw new TypeError("Callback must be a function");var s;return e&&(s=e,x.has(s)||x.set(s,[]),x.get(s)).push(t),this.subscribers.add(t),()=>this.unsubscribe(t)}unsubscribe(t){if("function"!=typeof t)throw new TypeError("Callback must be a function");this.subscribers.delete(t)}notifySubscribers(...t){this.subscribers.forEach(e=>e(...t))}}const _=new WeakMap,M={"zyx-live-list":({node:t,data:e})=>new S({container:t,...e})};class S{get startIndex(){return this.#n[0]}get endIndex(){return this.#n[1]}#i=new WeakMap;#o;#r;#a;#c;#n;#h;#l;#u;#d;#p=null;constructor({container:t=t,list:e=null,compose:s=null,debounce:n=1,range:i=null,after:o=null,offset:r=0}={}){if(!(e instanceof k||e instanceof c))throw new Error("list must be an instance of LiveList or LiveVar.interp() (LiveInterp)");t.liveDomList=this,this.#o=t,this.infiniteScrolling=null,_.set(t,this),this.#c=s,this.#u=o,this.#r=e,this.#n=i,this.#h=r,this.#l=n,this.#d=this.arrayModified.bind(this),e instanceof k?(this.#a=e,this.#a.subscribe(this.#d,this.#o)):e instanceof c&&(this.#a=this.#f(),this.#m(),this.#r.reactive.subscribe(this.liveVarChanged.bind(this),this.#o)),this.update()}get isUpdating(){return null!==this.#p}#f(){if(this.#r instanceof k)return this.#r;if(this.#r instanceof c){const t=this.#r.interprate();if(null==t||void 0===t)return new k([]);if(!(t instanceof k))throw new Error("LiveVar.interp() callback must return a LiveList instance or null/undefined");return t}throw new Error("Invalid list type")}#m(){this.#a&&this.#a.subscribe(this.#d,this.#o)}#y(){this.#a&&this.#a.removeListener(this.#d)}liveVarChanged(){this.#y(),this.#a=this.#f(),this.#m(),this.update()}arrayModified(t,e,...s){this.#p&&clearTimeout(this.#p),this.#p=setTimeout(()=>{this.update(),this.#p=null},this.#l)}forEach(t){for(const e of this.entries())t(e)}entries(){return Array.from(this.#o.children,t=>[t,this.#i.get(t)])}orderedEntires(){return Array.from(this.orderedDomItems(),t=>[t,this.#i.get(t)])}domItems(){return Array.from(this.#o.children,t=>this.#i.get(t))}orderedDomItems(){return Array.from(this.#o.children).sort((t,e)=>t.style.order-e.style.order)}get(t){return this.#i.get(t)}createCompose(t,...e){return this.#c?"object"==typeof this.#c.prototype?new this.#c(t,...e):this.#c(t,...e):t}getTarget(){if(null===this.#n)return Object.values(this.#a);const{start:t,end:e}=this.getRange();return Object.values(this.#a).slice(t,e)}getRange(){return{start:Math.max(0,this.#n[0]+this.#h),end:Math.min(this.#a.length,this.#n[1]+this.#h)}}getRangeHalf(){const t=this.getRange();return(t.start+t.end)/2}getRangeLength(){return this.getRange().end-this.getRange().start}updateRange(t){const e=t(this.#n);this.#n=[Math.max(0,e[0]),Math.max(0,e[1])],this.#o.setAttribute("data-range",this.#n.join(",")),this.update()}shiftRange(t){this.updateRange(e=>[e[0]+t,e[1]+t])}updateOffset(t){const e=t(this.#h);this.#h=Math.max(0,e),this.#o.setAttribute("data-offset",this.#h),this.update()}removeNonArrayElements(t){t=t||this.getTarget();const e=this.entries();for(const[s,n]of e)t.includes(n)||s.remove()}getCreateElements(t){t=t||this.getTarget();const e=this.domItems();let s=-1;return t.map(t=>{s++;let n=this.#i.get(t);if(n)return e.includes(t)||this.appendToContainer(n,t),{item:t,element:n,index:s};const i=this.createCompose(t);if(n=D(i),n instanceof HTMLTemplateElement||n instanceof DocumentFragment)throw Error("cannot associate reactive object with a template element");return this.appendToContainer(n,i),this.#i.set(n,t),"symbol"!=typeof t&&"object"!=typeof t||this.#i.set(t,n),{item:t,index:s,element:n}})}appendToContainer(t,e){this.#o.appendChild(t),this.infiniteScrolling&&this.infiniteScrolling.mutationObserver.observe(t);try{e.onConnected?.(t)}catch(t){console.error("item.onConnected error",t)}}update(){const t=this.getTarget();this.removeNonArrayElements(t);const e=this.getCreateElements(t);for(const{element:t,index:s}of e)t.style.order=s,t.setAttribute("list-index",s);this.#u&&this.#u()}}function L(t,e){if("object"!=typeof t||!("subscribe"in t))return t+e;const s=new T(t.value+e);return t.subscribe(t=>{s.set(t+e)},t),s}const C="###",P="tag",O=["this","push","ph"];class R{#g=!1;#v;#b;#w;#k;#E;#T;#x;#A;#_;#M;constructor(t,...e){this.#x=t,this.#A=e,this.#w=this.processTagData(),this.#b=this.becomeDOM(),this.#E=!1,this.#v=null,this.#k=null,this.#g=!1,this.#M=!1}logMap(){return this.#M=!0,this}cleanUp({keepMarkup:t=!1,keepRaw:e=!1,keepData:s=!1,keepMap:n=!1}={}){t||(this.#b=null),e||(this.#x=null),s||(this.#w=null,this.#A=null),n||(this.#k=null)}processTagData(){const t=this.#x.slice(0,-1);let e="";return this.#A.map((s,n)=>{e+=t.shift();let o="content",r=!1;/<\s*$/.test(e)?o=P:/=\s*$/.test(e)?(r=!0,o="unquoted-value"):/=\s*["']\s*$/.test(e)?(r=!1,o="quoted-value"):/<\/\s*$/.test(e)&&(o=P);const a=r?`"${i(n)}"`:i(n);return{context:o,value:s,replacement:o===P?s:a,needsPlaceholder:null!==s&&("object"==typeof s||"function"==typeof s)}})}becomeDOM(){return function(t){const e=t.childNodes;for(let s=0;s<2;s++)e[s]&&3===e[s].nodeType&&""===e[s].textContent.trim()&&t.removeChild(e[s]);return t}(function(t){const e=document.createElement("div");return e.innerHTML=t,e}(String.raw({raw:this.#x},...this.#w.map(({value:t,needsPlaceholder:e,replacement:s})=>e?s:t??""))))}const({keepRaw:t=!1,keepMarkup:e=!1,keepData:s=!1,keepMap:n=!1,mutationObserver:i=!1}={}){if(this.#g)return this;this.#k=this.mapEverything(),this.#M&&console.log("ZyXHTML: map",this.#k,{this:this}),this.replaceDOMPlaceholders();for(const{node:t,ph:e}of this.#k.phs)t.setAttribute("ph",e),this.thisAssigner(t,e),this.markAttributeProcessed(t,"ph",e);for(const{node:t,key:e}of this.#k.hasThis)this.thisAssigner(t,e),this.markAttributeProcessed(t,"this",e);for(const{node:t,key:e}of this.#k.hasPush)this.pushAssigner(t,e),this.markAttributeProcessed(t,"push",e);for(const{node:t,id:e}of this.#k.hasId)this.thisAssigner(t,e);for(const{node:t,attr:e,data:s}of this.#k.zyxBindAttributes){const n=B[e];try{n({zyxhtml:this,node:t,data:s}),this.markAttributeProcessed(t,e)}catch(i){console.error(i),console.error("ZyXHTML: Error binding attribute",{attr:e,node:t,handler:n,data:s}),this.markAttributeProcessed(t,`errored-${e}`,i)}}for(const{node:t,attr:e,data:s}of this.#k.zyxDynamicVars)s.createZyXHTMLReactiveNode(this,t,e),this.markAttributeProcessed(t,e);return!this.main&&this.#b.firstElementChild&&(this.thisAssigner(this.#b.firstElementChild,"main"),this.markAttributeProcessed(this.#b.firstElementChild,"main")),this.#v=this.#b.childNodes.length>1?function(t){const e=document.createElement("template");return e.content.append(...t.childNodes),e}(this.#b):this.#b,this.#E=this.#v instanceof HTMLTemplateElement,this.#E?this.#v=this.#v.content:this.#v=this.#v.firstElementChild,i&&this.setupSelfMutationObserver(),this.cleanUp({keepMarkup:e,keepRaw:t,keepData:s,keepMap:n}),this.#g=!0,this}mapEverything(){const t=[...this.#b.querySelectorAll("*")],e={placeholders:[],hasThis:[],hasId:[],zyxBindAttributes:[],zyxDynamicVars:[],phs:[],hasPush:[]};for(const s of t){if(s.matches(n)){const t=s.getAttribute("id");if(t){const n=this.#w[t]?.value;e.placeholders.push({node:s,phid:t,dataValue:n})}continue}if(s.hasAttribute("ph"))e.phs.push({node:s,ph:s.getAttribute("ph")});else if(s.hasAttribute("this")&&e.hasThis.push({node:s,key:s.getAttribute("this")}),s.hasAttribute("push"))e.hasPush.push({node:s,key:s.getAttribute("push")});else{s.hasAttribute("id")&&e.hasId.push({node:s,id:s.getAttribute("id")});for(const t of[...s.attributes]){const n=o(t.value),i=this.#w[n]?.value;t.name in B&&e.zyxBindAttributes.push({node:s,attr:t.name,data:i}),i&&i instanceof c&&e.zyxDynamicVars.push({node:s,attr:t.name,data:i})}}}return{all:t,...e}}replaceDOMPlaceholders(){if(this.#k?.placeholders?.length)for(const{node:t,dataValue:e}of this.#k.placeholders)try{e instanceof c?e.createZyXHTMLReactiveNode(this,t,null):t.replaceWith(D(e))}catch(t){console.error("Error replacing DOM placeholder:",t)}}setupSelfMutationObserver(){this.#_=new MutationObserver(t=>{}),this.#_.observe(this.#v,{childList:!0,subtree:!0})}thisAssigner(t,e){if(t&&e)try{const s=e.split(" ");if(1===s.length){const e=s[0];t.__key__=e,this[e]=t,this.#T&&(this.#T[e]=t)}else for(const e of s)e&&e.trim()&&(t.__key__=e,this[e]=t,this.#T&&(this.#T[e]=t))}catch(t){console.error("Error in thisAssigner:",t)}}pushAssigner(t,e){this[e]||(this[e]=[]),this[e].push(t),this.#T&&(this.#T[e]||(this.#T[e]=[]),this.#T[e].push(t))}markAttributeProcessed(t,e,s){O.includes(e)?t.removeAttribute(e):t.setAttribute(`${e}-processed`,s||""),t.setAttribute(e,"")}get markup(){return this.const().#v}appendTo(t){return t.append(this.markup),this}prependTo(t){return t.prepend(this.markup),this}place(t){return function(t,e){if("object"==typeof e)return e.replaceWith(t);const s=document.querySelector(`ph[${e}]`);if(!s)throw new Error(`${e} not found`);s.replaceWith(t)}(this.markup,t),this}bind(t,e={}){return this.#T=t,t[C]=this,t.appendTo=t=>this.appendTo(t),t.prependTo=t=>this.prependTo(t),t.place=t=>this.place(t),this.const(e)}join(t){return this.#T=t,t?.[C]&&Object.assign(this,t[C]),this.const()}touch(t){return console.warn("ZyXHTML: touch is deprecated"),t({proxy:this,markup:this.markup}),this}}function D(t){return!1===t||null==t?"":Array.isArray(t)?function(t){const e=document.createElement("template");return e.content.append(...t.map(D)),e}(t).content:"function"==typeof t?D(t()):t?.[C]instanceof R?t[C].markup:t instanceof R?t.markup:t instanceof HTMLTemplateElement?t.content:t}R.prototype.super=R.prototype.join;const B={...p,...v,...M,"zyx-insert-n":({zyxhtml:t,node:e,data:s})=>{const[n,i]=s;for(let s=0;s<n;s++)e.append(D(i(t,s,n)))},"zyx-insert-entries":({zyxhtml:t,node:e,data:s})=>{const[n,i,o]=s;for(const[s,r]of Object.entries(n)){const n=i(t,s,r);if(e.append(D(n)),o)if("string"==typeof o)t.pushAssigner(n,o);else{if(!Array.isArray(o))throw new Error("Invalid groupname");o.push(n)}}},"zyx-transform":({node:t,data:e})=>{t.zyxTrans=function(t,e){if(!(t instanceof HTMLElement))throw new Error("zyxTransform requires a valid HTMLElement");const s={};let n={},i="";function o(t){if(!t||"string"!=typeof t)throw new Error("Snapshot name must be a non-empty string");s[t]={...n}}function r(t){n=t,h(),l()}function a(t){if(!t||"string"!=typeof t)throw new Error("Restore name must be a non-empty string");return t in s?(r(null),r(s[t]),!0):(console.warn(`No snapshot found with name: ${t}`),!1)}function c(){if(e){for(const t in e){const s=e[t];"object"==typeof s&&"reset"in s&&s.reset()}h(),l()}else n={},t.style.transformOrigin="50% 50%",t.style.transform=""}function h(){const e="object"==typeof n.originX&&"subscribe"in n.originX?n.originX.value:n.originX||"50%",s="object"==typeof n.originY&&"subscribe"in n.originY?n.originY.value:n.originY||"50%";t.style.transformOrigin=`${e} ${s}`}function l(){const e=[];for(const[t,s]of Object.entries(n))if(s&&"originX"!==t&&"originY"!==t){const n="object"==typeof s&&"subscribe"in s?s.value:s;e.push(`${t}(${n})`)}i=e.join(" "),t.style.transform=i}return e&&function(){if(!e)return;const s=[{key:"scale",unit:""},{key:"rotateX",unit:"deg"},{key:"rotateY",unit:"deg"},{key:"rotateZ",unit:"deg"},{key:"translateX",unit:"px"},{key:"translateY",unit:"px"},{key:"translateZ",unit:"px"},{key:"originX",unit:"%"},{key:"originY",unit:"%"}];for(const{key:i,unit:o}of s)if(i in e){const s=e[i];"object"==typeof s&&"subscribe"in s?(n[i]="scale"===i?s:L(s,o),"originX"===i||"originY"===i?s.subscribe(h,t):s.subscribe(l,t)):n[i]="scale"===i?s:s+o}h(),l()}(),Object.assign(t,{set:r,snapshot:o,restore:a,resetTransforms:c}),{set:r,snapshot:o,restore:a,resetTransforms:c}}(t,e?.map)},"zyx-shadowroot":({node:t})=>{!function({node:t}){if(t.shadow)return;t.shadow=t.attachShadow({mode:"open"});const e=document.createElement("style");t.shadow.append(...t.childNodes),t.shadow.append(e),t.loadCSS=async e=>{if(Array.isArray(e)){for(const s of e)await t.loadCSS(s);return}const s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=e,await new Promise((e,n)=>{s.onload=()=>e(),s.onerror=n,t.shadow.appendChild(s)})},t.removeAttribute("zyx-shadowroot")}({node:t})}};function N(...t){return new R(...t)}function F(t,e,s={}){return s.form?X(t,e,s):fetch(t,{headers:new Headers({"Content-Type":"application/json"}),method:"POST",credentials:"include",body:JSON.stringify(e),...s})}function I(t,e={}){return fetch(t,{headers:new Headers({"Content-Type":"application/json"}),method:"GET",credentials:"include",...e})}function X(t,e,s={}){const n=new FormData;return Object.entries(e).forEach(([t,e])=>n.append(t,e)),fetch(t,{method:"POST",credentials:"include",body:n,...s})}function j(t){return new Promise((e,s)=>{const n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onload=()=>{n.remove(),e({link:n,remove:()=>n.remove()})},n.onerror=s,n.href=t,document.head.appendChild(n)})}async function q(t){const e=await fetch(t);if(e.ok){const t=await e.blob();return{blob:t,objectURL:URL.createObjectURL(t)}}throw new Error("Blob fetch failed")}async function z(t){return new Promise((e,s)=>{const n=new Image;n.onload=()=>e(n),n.onerror=s,n.src=t})}async function Y(t,e){const s=await z(t);e=e||512;const n=document.createElement("canvas"),i=n.getContext("2d"),[o,r]=function(t,e,s){if(t>s||e>s){const n=s/Math.max(t,e);return[t*n,e*n]}return[t,e]}(s.width,s.height,e);return n.width=o,n.height=r,i.drawImage(s,0,0,o,r),n}function U(t){const e=t.replace(/^.*[\\\/]/,"").split("?")[0];return{filename:e,ext:e.split(".").pop()}}async function H(t,e={}){const s=await fetch(t,{headers:new Headers({"Content-Type":"application/json"}),credentials:"include",...e});if(!s.ok)throw new Error(`Request failed with status ${s.status}`);return s.json()}function V(t,e){return fetch(t,{headers:new Headers({"Content-Type":"application/json"}),method:"PUT",credentials:"include",body:JSON.stringify(e)})}function $(t){return fetch(t,{headers:new Headers({"Content-Type":"application/json"}),method:"DELETE",credentials:"include"})}async function W(t){return new Promise((e,s)=>{const n=document.createElement("script");n.src=t,n.onload=()=>e(n),n.onerror=s,document.head.appendChild(n)})}async function K(t,e="application/octet-stream"){const s=new Blob([t],{type:e});return{blob:s,objectURL:URL.createObjectURL(s)}}async function Z(t,e={},s=5e3){const n=new AbortController,i=setTimeout(()=>n.abort(),s);try{return await fetch(t,{...e,signal:n.signal})}finally{clearTimeout(i)}}class J{constructor({root:t}={}){N` <styles this="styles"></styles> `.bind(this),t&&this.appendTo(t)}async loadUrl(t){const{link:e,remove:s}=await j(t);return this.styles.appendChild(e),{link:e,remove:s}}async str(t,...e){const s=String.raw(t,...e);if(String(s).startsWith("url(")){const t=s.split("url(").slice(1).map(t=>t.split(")")[0]);for(const e of t)await this.loadUrl(e);return}return N`<style this="style">${s}</style>`.appendTo(this.styles)}cloneType(t){return new J({root:t})}}const Q=new J({root:"undefined"!=typeof document&&document.head});function G(t,...e){return Q.str(t,...e)}const tt=new class{get(t,e){const s=t+"=",n=decodeURIComponent(document.cookie),i=n.split(";");if(!n.includes(t))return this.set(t,e),e;for(let t in i){let e=i[t];for(;" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(s)){let t=e.substring(s.length,e.length);return"true"===t||"false"===t?"true"===t:t}}return""}set(t,e,s){const n=new Date;s?n.setTime(n.getTime()+24*s*60*60*1e3):n.setTime(n.getTime()+8639136e5);const i="expires="+n.toUTCString();document.cookie=`${t}=${e};${i};path=/`}delete(t){console.log("deleting cookie",t),this.set(t,"",-1)}};function et(t,e=!0){if(e&&t<0)throw new Error("Sleep duration cannot be negative");return new Promise(e=>setTimeout(e,Math.max(0,t)))}class st{#S;#L;#C;#P;constructor({url:t,type:e="module",errorHandler:s=console.error}){this.#S=new Worker(t,{type:e}),this.#L=new Map,this.#C=new Map,this.#P=s,this.#S.onmessage=this.#O.bind(this),this.#S.onerror=this.#R.bind(this)}on(t,e){return this.#C.has(t)||this.#C.set(t,new Set),this.#C.get(t).add(e),()=>this.off(t,e)}off(t,e){const s=this.#C.get(t);s&&s.delete(e)}async execute(t){const e=crypto.randomUUID(),s=new Promise((t,s)=>{this.#L.set(e,{resolve:t,reject:s})});return this.#S.postMessage({...t,taskId:e}),s}terminate(){this.#S.terminate(),this.#L.clear(),this.#C.clear()}#O(t){const{taskId:e,error:s,data:n,type:i}=t.data;if("event"===i){const t=this.#C.get(n.event);return void(t&&t.forEach(t=>{try{t(n.payload)}catch(t){this.#P(t)}}))}const o=this.#L.get(e);o&&(this.#L.delete(e),s?o.reject(new Error(s)):o.resolve(n))}#R(t){this.#P(t)}}class nt{#D;#B;constructor({delay:t=1,immediate:e=!1}={}){this.#D=!1,this.#B=new Promise((s,n)=>{const i=async()=>{try{"function"==typeof this.asyncInit&&await this.asyncInit(),this.#D=!0,s()}catch(t){n(t)}};e?queueMicrotask(i):setTimeout(i,t)})}get isInitialized(){return this.#D}async waitForInit(){await this.#B}}class it{#N;#F;constructor({delay:t=1,microtask:e=!1}={}){this.#N=t,this.#F=e,this.callAsyncConstructor()}callAsyncConstructor(){"function"==typeof this?.asynConstructor?this.#F?queueMicrotask(t=>this.asynConstructor()):setTimeout(t=>this.asynConstructor(),this.#N):console.warn("you are using a (new AsynConstructor()) class without an async asynConstructor method.")}}async function ot(t,e,s){const n=[],i=new Set;for(const o of e){const r=Promise.resolve().then(()=>s(o,e));if(n.push(r),t<=e.length){const e=r.then(()=>i.delete(e));i.add(e),i.size>=t&&await Promise.race(i)}}return Promise.all(n)}const rt=new WeakMap;"undefined"!=typeof window&&(window.zyxMap=rt);const at=(t,e)=>{let s=rt.get(t);return s||(rt.set(t,{banks:{}}),s=rt.get(t)),e in s.banks||(s.banks[e]={}),s.banks[e]};function ct(t,e){const s=at(t,"delayChains");if(e in s){for(const t of s[e].pending)clearTimeout(t);s[e].pending=[],s[e].callbacks=[]}else s[e]={callbacks:[],pending:[]};const n=()=>s[e].callbacks.length>0&&s[e].callbacks.splice(0,1)[0](),i=()=>({then:(t,o)=>(s[e].callbacks.push(()=>{s[e].pending.push(setTimeout(e=>{t(),n()},o))}),i())});return s[e].pending.push(setTimeout(n,1)),i()}function ht(t,e){const s=at(t,"delayChains");if(e in s){for(const t of s[e].pending)clearTimeout(t);s[e]={callbacks:[],pending:[]}}}function lt(t,e,s,n){return new Promise((i,o)=>{const r=at(t,"delays");e in r&&clearTimeout(r[e].timeout),s=s||0,r[e]=n?{func:n,timeout:setTimeout(()=>i(n()),s)}:{func:n,timeout:setTimeout(i,s)}})}function ut(t,...e){const s=at(t,"delays");if(e.length>1)for(const t in e)t in s&&clearTimeout(s[t]?.timeout);else clearTimeout(s[e[0]]?.timeout)}function dt(t,e){const s=at(t,"delays");e in s&&(clearTimeout(s[e].timeout),s[e].func())}function pt(t,e,s,n){const i=at(t,"debouncers");if(e in i)i[e](s);else{try{s(),s=null}catch(t){throw new Error(t)}setTimeout(t=>{try{s&&s()}catch(t){throw new Error(t)}delete i[e]},n),i[e]=t=>s=t}}class ft{#I={};on(t,e){if("string"!=typeof t)throw new TypeError("Event name must be a string");if("function"!=typeof e)throw new TypeError("Callback must be a function");t.includes(",")?t.split(",").forEach(t=>this.on(t.trim(),e)):(t in this.#I||(this.#I[t]=[]),this.#I[t].push(e))}call(t,...e){if("string"!=typeof t)throw new TypeError("Event name must be a string");const s=this.#I[t];if(s)for(const n of s)try{n(...e)}catch(s){console.error(`Error in event handler for '${t}':`,s),this.call("error",s,t,e)}}off(t,e){if("string"!=typeof t)throw new TypeError("Event name must be a string");t.includes(",")?t.split(",").forEach(t=>this.off(t.trim(),e)):t in this.#I&&(e?this.#I[t]=this.#I[t].filter(t=>t!==e):delete this.#I[t])}listenerCount(t){return this.#I[t]?.length||0}}function mt(t,e,s,n={}){e.split(" ").forEach(e=>t.addEventListener(e,s,n))}function yt(t,e,s,n={}){e.split(" ").forEach(e=>t.removeEventListener(e,s,n))}function gt(t,e,s){return Math.min(Math.max(t,e),s)}function vt(t,e,s){return t+(e-t)*s}function bt(t,e,s,n,i){return(t-e)*(i-n)/(s-e)+n}function wt(t,e){return Math.max(0,(-e+t)/(1-e))}function kt(t,e){return Math.min(1,t/e)}function Et(t,e){return Math.round(t/e)*e}function Tt(t,e){const s=Math.pow(10,e);return Math.round(t*s)/s}function xt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function At(t,e,s){return Tt(Math.random()*(e-t)+t,s)}function _t(t){return t%2==0}function Mt(t){return t%2!=0}function St(t){return Number.isInteger(t)}function Lt(t){return!Number.isInteger(t)}function Ct(t){return["up","right","down","left"][Math.round(t/90)%4]}class Pt{constructor(t){this.AUDIO_ROOT=t,this.ctx=new AudioContext,this.gainNode=this.ctx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.ctx.destination),this.SOUNDS={},this.muted=!1,this.activeSources=new Set,this.backgroundMusic=null,this.backgroundMusicPosition=0,this.isChangingBackgroundMusic=!1,this.filters=null,this.filtersEnabled=!1}setupFilters(){this.filters||(this.filters={lowpass:this.ctx.createBiquadFilter(),highpass:this.ctx.createBiquadFilter(),bandpass:this.ctx.createBiquadFilter()},this.filters.lowpass.type="lowpass",this.filters.highpass.type="highpass",this.filters.bandpass.type="bandpass",this.filters.lowpass.frequency.value=2e4,this.filters.highpass.frequency.value=20,this.filters.bandpass.frequency.value=1e3,this.filters.bandpass.Q.value=1,this.filters.lowpass.connect(this.filters.highpass),this.filters.highpass.connect(this.filters.bandpass),this.filters.bandpass.connect(this.gainNode))}async addSound(t){return new Promise((e,s)=>{if(Object.keys(this.SOUNDS).includes(t))return e();let n=new XMLHttpRequest;n.onload=n=>{this.ctx.decodeAudioData(n.target.response,s=>{this.SOUNDS[t]=s,e(this.SOUNDS[t])},t=>{s(new Error(`Failed to decode audio data: ${t.message}`))})},n.onerror=()=>s(new Error(`Failed to load audio file: ${t}`)),n.open("GET",this.AUDIO_ROOT+t,!0),n.responseType="arraybuffer",n.send()})}stop(t){t.stop&&t.stop(),t.disconnect&&t.disconnect(),this.activeSources.delete(t)}toggleMute(){return this.muted=!this.muted,this.gainNode.gain.value=this.muted?0:1,this.muted}createBuffer(t,e){const s=this.ctx.createBufferSource();return s.buffer=this.SOUNDS[t],this.filtersEnabled?(this.setupFilters(),s.connect(this.filters.lowpass)):s.connect(this.gainNode),e||(e=()=>{this.stop(s)}),s.onended=()=>e(),this.activeSources.add(s),s}createAndExecute(t,e){return this.createBuffer(t,e).start(0)}async fadeVolume(t,e=1){this.gainNode.gain.value;const s=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(Ot(t),s,e)}async playBackgroundMusic(t,e={}){const{fadeIn:s=2,fadeOut:n=2,volume:i=.5,loop:o=!0}=e;if(this.isChangingBackgroundMusic)console.log("Already changing background music, ignoring new request");else{this.isChangingBackgroundMusic=!0;try{if(this.backgroundMusic){console.log("Fading out background music",n);const t=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(0,t,n/3),await new Promise(t=>setTimeout(t,1e3*n)),this.backgroundMusic&&(this.stop(this.backgroundMusic),this.backgroundMusic=null)}await this.addSound(t);const e=this.ctx.createBufferSource();e.buffer=this.SOUNDS[t],this.filtersEnabled?(this.setupFilters(),e.connect(this.filters.lowpass)):e.connect(this.gainNode),this.activeSources.add(e),e.loop=o,this.gainNode.gain.value=0,e.start(0),this.backgroundMusic=e,console.log("Fading in background music",s);const r=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(Ot(i),r,s/3),await new Promise(t=>setTimeout(t,1e3*s))}finally{this.isChangingBackgroundMusic=!1}}}setPlaybackRate(t,e){t&&t.playbackRate&&(t.playbackRate.value=e)}setStereoPan(t,e){t&&t.pan&&(t.pan.value=Math.max(-1,Math.min(1,e)))}setFilter(t,e,s=1){const n=this.filters[t];n&&(n.frequency.value=e,n.Q.value=s)}async play({source:t,name:e,looping:s=!1,delay:n=0,volume:i=1,n:o=0,playbackRate:r=1,pan:a=0,fadeIn:c=0,onEnded:h=null}={}){if(await this.addSound(e),0!==(i=this.muted?0:i)){if(this.gainNode.gain.value=c>0?0:Ot(i),s||o){s=!0;let l=o-- >0,u=()=>{h&&h(),!s||l&&o--<=0?h&&l&&o<0&&h(!0):setTimeout(s=>{t=this.createAndExecute(e,u),this.setPlaybackRate(t,r),this.setStereoPan(t,a)},n)};return t=this.createAndExecute(e,u),this.setPlaybackRate(t,r),this.setStereoPan(t,a),c>0&&this.fadeVolume(i,c),{source:t,stop:()=>s=!1,setPlaybackRate:e=>this.setPlaybackRate(t,e),setPan:e=>this.setStereoPan(t,e),setVolume:t=>this.fadeVolume(t)}}{const t=()=>{h&&h(),this.stop(s)},s=this.createBuffer(e,t);return s.start(0),this.setPlaybackRate(s,r),this.setStereoPan(s,a),c>0&&this.fadeVolume(i,c),s}}}stopAll(){this.activeSources.forEach(t=>this.stop(t))}pauseAll(){this.activeSources.forEach(t=>{t.stop&&t.stop()})}async pauseBackgroundMusic(t=.5){if(!this.backgroundMusic||this.isChangingBackgroundMusic)return!1;this.isChangingBackgroundMusic=!0;try{if(this.backgroundMusicPosition=this.ctx.currentTime-this.backgroundMusic.startTime,t>0){const e=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(0,e,t/3),await new Promise(e=>setTimeout(e,1e3*t))}return"running"===this.ctx.state&&await this.ctx.suspend(),!0}finally{this.isChangingBackgroundMusic=!1}}async resumeBackgroundMusic(t=.5,e=.5){if(!this.backgroundMusic||this.isChangingBackgroundMusic)return!1;this.isChangingBackgroundMusic=!0;try{if("suspended"===this.ctx.state&&await this.ctx.resume(),t>0){this.gainNode.gain.value=0;const s=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(Ot(e),s,t/3),await new Promise(e=>setTimeout(e,1e3*t))}else this.gainNode.gain.value=Ot(e);return!0}finally{this.isChangingBackgroundMusic=!1}}async stopBackgroundMusic(t=.5){if(!this.backgroundMusic||this.isChangingBackgroundMusic)return!1;this.isChangingBackgroundMusic=!0;try{if(t>0){const e=this.ctx.currentTime;this.gainNode.gain.setTargetAtTime(0,e,t/3),await new Promise(e=>setTimeout(e,1e3*t))}return this.stop(this.backgroundMusic),this.backgroundMusic=null,this.backgroundMusicPosition=0,!0}finally{this.isChangingBackgroundMusic=!1}}isMusicPlaying(){return null!==this.backgroundMusic&&"running"===this.ctx.state}getMusicState(){return this.backgroundMusic?"running"===this.ctx.state?"playing":"paused":"stopped"}getCurrentTime(t){return t?t.context.currentTime-t.startTime:0}seek(t,e){t&&t.buffer&&(t.stop(),t.start(0,e))}}function Ot(t){return t<=0?0:t>=1?1:Math.pow(t,3)}class Rt{constructor(t){this.defaultFocusable=t,this.focusedModuleRef=null}getFocusedModule(){const t=this.focusedModuleRef?.deref();if(!t)return null;if(!(t.__focusable__ instanceof Dt))throw new Error("Module is not bound with Focusable class.");return t}setDefaultFocusable(t){if(!(t.__focusable__ instanceof Dt))throw new Error("Module is not a Focusable instance.");this.defaultFocusable=t}setFocus(t){const e=this.getFocusedModule();if(e&&e.__focusable__.unFocus(),null===t&&(t=this.defaultFocusable),!(t.__focusable__ instanceof Dt))throw new Error("Module is not a Focusable instance.");const s=t.__focusable__.redirect();this.focusedModuleRef=new WeakRef(s),s.__focusable__.focus()}}class Dt{constructor(t){this.module=t,this.focused=!1,this.redirectTo=null}redirect(){const t=this.redirectTo?.deref();return t||this.module}setRedirection(t){this.redirectTo=t?new WeakRef(t):null}focus(){this.focused=!0}unFocus(){this.focused=!1}}function Bt(t,e,s){return[...t.querySelectorAll(e)].forEach(s)}function Nt(t,e){Object.entries(e).forEach(([e,s])=>t.style.setProperty(e,s))}async function Ft(t,e,s,n,i,o){if(o=o||"em",i){const t=e.getBoundingClientRect();s-=t.left,n-=t.top}t.style[n>=0?"top":"bottom"]=`${Math.abs(n)}${o}`,t.style[s>=0?"left":"right"]=`${Math.abs(s)}${o}`,e.appendChild(t),await et(1);const{offsetWidth:r,offsetHeight:a}=t,{offsetWidth:c,offsetHeight:h}=e,{left:l,top:u,bottom:d,right:p}=t.getBoundingClientRect();(l<0||u<0||d>h||p>c)&&(d>h&&(t.style.top=h-a+"px"),p>c&&(t.style.left=c-r+"px"))}function It(t,e){return t.composedPath?.().some(t=>t===e)??!1}function Xt(t,e){return t.composedPath?.().find(t=>t.matches?.(e))??null}function jt({h:t=0,s:e=0,l:s=0}={}){return{h:`${t}deg`,s:`${e}%`,l:`${s}%`}}function qt(t){const e=t.replace("#","");return{r:parseInt(e.substring(0,2),16)/255,g:parseInt(e.substring(2,4),16)/255,b:parseInt(e.substring(4,6),16)/255}}function zt(t){const{r:e,g:s,b:n}=qt(t),i=Math.max(e,s,n),o=Math.min(e,s,n);let r=0,a=0;const c=(i+o)/2;if(i!==o){const t=i-o;switch(a=c>.5?t/(2-i-o):t/(i+o),i){case e:r=(s-n)/t+(s<n?6:0);break;case s:r=(n-e)/t+2;break;case n:r=(e-s)/t+4}r/=6}return{h:Math.round(360*r),s:Math.round(100*a),l:Math.round(100*c)}}function Yt({h:t=0,s:e=0,l:s=0}={}){let n,i,o;if(t/=360,s/=100,0==(e/=100))n=i=o=s;else{const r=(t,e,s)=>(s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(e-t)*s:s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t),a=s<.5?s*(1+e):s+e-s*e,c=2*s-a;n=r(c,a,t+1/3),i=r(c,a,t),o=r(c,a,t-1/3)}const r=t=>{const e=Math.round(255*t).toString(16);return 1===e.length?"0"+e:e};return`#${r(n)}${r(i)}${r(o)}`}function Ut(t){return t>1?"s":""}function Ht(t,e){const s=[...t];for(let t=s.length-1;t>0;t--){const n=Math.floor(Vt(e)*(t+1));[s[t],s[n]]=[s[n],s[t]],e++}return s}function Vt(t){const e=1e4*Math.sin(t++);return e-Math.floor(e)}function $t(t){const e=t.toString(),s=e.length;if(s<4)return e;if(4===s)return e.slice(0,1)+","+e.slice(1);const n=e.slice(0,3),i=Math.floor(s/3);if(i>5)return"a lot";const o=s-3*i;return(o?n.slice(0,o)+"."+n.slice(o):n)+["h","k","m","b","t","q"][o?i:i-1]}function Wt(t,{onDown:e,onUp:s,once:n=!1,capture:i=!1,label:o="rightclick"}={}){if(t){if(!s)throw new Error("[ZyXInput] onUp required for RightClick");this.on(t).pointerDownMoveUp({label:o,onDown:n=>{const{moveFuse:i,pointerDown:o,eventFuse:r}=n;return e?.(n),Ls(t).delay("pointer-down",this.mobilePressHoldDelay,()=>{i.true||o.false||r.false||this.kingOfTheStack(r,()=>s(n))}),!0},onUp:t=>{const{up_e:e,moveFuse:n,eventFuse:i}=t;if("mouse"===e.pointerType&&2===e.button){if(n.true||i.false)return;this.kingOfTheStack(i,()=>s(t))}},once:n,capture:i})}else console.warn("[ZyXInput] Invalid element for RightClick handler")}function Kt(t,e){const{onClick:s=null,onDown:n=null,once:i=!1,capture:o=!1,stopPropagation:r=!1,stopImmediatePropagation:a=!1,preventDefault:c=!0,label:h="click"}=e,l=e=>{if(r&&e.stopPropagation(),a&&e.stopImmediatePropagation(),1!==e.which)return;const i=this.beforePointerEvent("clickone",e);if(!i)return;const o=new ie(!0,{label:h});this.activeEvents.add(o);const c=n?.({dwn_e:e,kingOfTheStack:t=>this.kingOfTheStack(o)}),{clientX:l,clientY:u,target:d}=e,{check:p}=this.moveTripper({startX:l,startY:u});s&&t.addEventListener("pointerup",t=>{!p(t)&&o.true&&t.target===d&&this.kingOfTheStack(o,()=>s({dwn_e:e,up_e:t,down_return:c,eventFuse:o},i))},{once:!0})};return t.addEventListener("pointerdown",l,{once:i,capture:o}),c&&t.addEventListener("click",t=>t.preventDefault(),{once:i,capture:o}),{unbind:()=>{t.removeEventListener("pointerdown",l,{capture:o}),t.removeEventListener("click",t=>t.preventDefault(),{capture:o})}}}function Zt(t,e){t&&"function"==typeof e?(t.setAttribute("click-enabled",""),t.addEventListener("pointerdown",s=>{if(!this.beforePointerEvent("custom-click",s))return nullifyEvent(s);t.addEventListener("click",()=>{e()},{once:!0})})):console.warn("[ZyXInput] Invalid parameters for Click handler")}function Jt(t,{single:e,double:s,doubleWait:n=!1,cooldown:i,cooldownDuration:o=this.clickOrTwoWindowMs,button:r=0,label:a="click-or-two",preventDefault:c=!0}={},{activeFuse:h=new ie,dblClickFuse:l=new ie,singleClickTimeout:u=null}={}){t?this.on(t).pointerDownMoveUp({label:a,onDown:t=>{const{dwn_e:e,moveFuse:s,pointerDown:n,eventFuse:o}=t;if(!(i||s.true||n.false||o.false)&&e.button===r)return!0},onUp:t=>{const{up_e:a,moveFuse:c,eventFuse:d}=t;if(!("mouse"===a.pointerType&&a.button!==r||c.true||d.false)){if(h.true)return d.true&&(u&&(clearTimeout(u),u=null),s(t),i=setTimeout(()=>i=null,o)),h.reset(),void l.reset();h.setTrue(),u=setTimeout(()=>{h.true&&d.true&&e(t),h.reset(),u=null},n||o)}},once:!1,capture:!1}):console.warn("[ZyXInput] Invalid element for ClickOrTwo handler")}function Qt(t,{onDown:e,onStartMove:s,onMove:n,onUp:i,once:o=!1,deadzone:r=null,capture:a=!1,captureMove:c=!1,verbose:h=!1,stopPropagation:l=!1,stopImmediatePropagation:u=!1,stopMovePropagation:d=!1,stopImmediateMovePropagation:p=!1,movePrecision:f=1,label:m="pointerDownMoveUp"}={}){if(!t)return void console.warn("[ZyXInput] Invalid element for PointerDownMoveUp handler");const y=o=>{if(r=r||this.moveTripperDist,!this.beforePointerEvent("pointerDownMoveUp",o))return!1;const{eventFuse:a=new ie(!0,{label:m}),pointerDown:y=new ie(!0,{label:m}),startX:g,startY:v}={startX:o.clientX,startY:o.clientY};this.activeEvents.add(a);const{moveFuse:b,check:w}=this.deadzone({startX:g,startY:v,deadzone:r});l&&o.stopPropagation(),u&&o.stopImmediatePropagation();const k=o.composedPath();let{startAngle:E=null,moveCalledOnce:T=!1,latest_move_e:x=null,startMove:A,pixels_moved:_=0}={};const M=e?.({composedPath:k,dwn_e:o,moveFuse:b,pointerDown:y,eventFuse:a,kingOfTheStack:t=>this.kingOfTheStack(a),pathContains:t=>It(o,t),pathContainsMatching:t=>Xt(o,t)});if(!M)return!1;const S=t=>function(t,e,s,n){const i=s-t,o=n-e;let r=Math.atan2(o,i)*(180/Math.PI);return r<0&&(r+=360),r+=90,r>=360&&(r-=360),r}(g,v,t.clientX,t.clientY),L=t=>Math.sqrt(Math.pow(t.clientX-g,2)+Math.pow(t.clientY-v,2)),C=t=>{return e=S(t),[0,90,180,270,0][Math.round(e/90)%4];var e},P=e=>{try{if(a.false)return h&&console.log({element:t},"eventFuse.false, returning"),R();if(_++,f>1){if(_<f)return;_=0}if(x=e,!w(e))return;E||(E=S(e));const r={dwn_e:o,mv_e:e,startX:g,startY:v,startAngle:E,movementX:e.movementX,movementY:e.movementY,stop:R,up:O,moveFuse:b,startMove:A,kingOfTheStack:t=>this.kingOfTheStack(a),clearAllSelections:()=>this.clearAllSelections(),fourAngleSnap:()=>C(e),angleFromStart:()=>S(e),distanceFromStart:()=>L(e),direction:()=>Ct(S(e))};if(d&&e.stopPropagation(),p&&e.stopImmediatePropagation(),T&&n)return n(r,M);if(s){if(A=s(r,M),!A)return!1;"object"==typeof A&&null!==A&&("onMove"in A&&(n=A.onMove),"onUp"in A&&(i=A.onUp))}this.kingOfTheStack(a),T=!0}catch(t){console.error("[ZyXInput] Error in move handler:",t)}},O=t=>{y.setFalse(),R();const e={dwn_e:o,up_e:t,composedPath:k,mv_e:x,startX:g,startY:v,startAngle:E,startMove:A,moveFuse:b,onStartMove:s,eventFuse:a,fourAngleSnap:()=>C(t),angleFromStart:()=>S(t),distanceFromStart:()=>L(t),direction:()=>Ct(S(t))};i?.(e,M)};document.addEventListener("pointermove",P,{capture:c}),document.addEventListener("pointerup",O),document.addEventListener("pointercancel",O);const R=()=>{document.removeEventListener("pointermove",P,{capture:c}),document.removeEventListener("pointerup",O),document.removeEventListener("pointercancel",O)}};return t.addEventListener("pointerdown",y,{once:o,capture:a}),{removeEventListener:()=>t.removeEventListener("pointerdown",y,{capture:a})}}function Gt(t,{onWheel:e,capture:s=!1,passive:n=!1}={}){if(!t||"function"!=typeof e)return void console.warn("[ZyXInput] Invalid parameters for Wheel handler");const i=t=>{e({whl_e:t,killPropagation:()=>{t.stopPropagation(),t.stopImmediatePropagation()},pathContains:e=>It(t,e),pathContainsMatching:e=>Xt(t,e)})};return t.addEventListener("wheel",i,{capture:s,passive:n}),{unbind:()=>{t.removeEventListener("wheel",i,{capture:s})}}}function te(t,...e){this.on(t).clickOrTwo({single:e=>window.open(t.href,"_blank"),double:e=>window.open(t.href,"_blank",["height=1400","width=1000","top=10","left=10"].join(","))})}class ee{constructor(t,e,{scrollTarget:s,directions:n="y",overrideDefaultScroll:i=!0,onPointerMove:o,onWheel:r,onScroll:a,swapY:c,swapX:h}={}){e?(this.directions="x"===n?{x:!0,y:!1}:"y"===n?{x:!1,y:!0}:{x:!0,y:!0},this.container=e,this.scrollTarget=s||e,this.container._momentumScroll=this,this.swapY=c,this.swapX=h,this.velocityY=0,this.animating=!1,this.pointerDown=!1,this.direction="down",this.onScroll=a,this.velocityX=0,this.friction=.94,this.minVelocityY=1,this.maxVelIncr=20,this.maxVelocityY=400,this.minVelocityX=1,this.maxVelocityX=400,this.smallDeltaStep={floor:10,culm:0,culmLimit:10,tick:10},this.smallDeltaStepX={floor:10,culm:0,culmLimit:20,tick:20},this.tick_length=8,this.lastFramePerf=null,i&&this.container.addEventListener("wheel",t=>{r&&!r(t)||this.wheel(t)},{capture:!0,passive:!1}),this._setupPointerEvents(t,o)):console.warn("[ZyXInput] Invalid container for MomentumScroll")}_setupPointerEvents(t,e){t.on(this.container).pointerDownMoveUp({capture:!0,captureMove:!0,onDown:({dwn_e:t})=>!this._checkPathForMomentumScroll(t)&&(this.pointerDown=!0,!0),onStartMove:({direction:t,stop:e,clearAllSelections:s}={})=>{const n=t(),i="left"===n||"right"===n;return("up"===n||"down"===n)&&!this.directions.y||i&&!this.directions.x?e():(this.directions.y&&(s(),this.container.requestPointerLock()),!0)},onMove:({mv_e:t,movementY:s,movementX:n}={})=>{if(t.stopPropagation(),t.stopImmediatePropagation(),this.directions.y&&0===s&&this.directions.x&&0===n)return;this.container.classList.add("Scrolling"),e?.({mv_e:t,movementY:s,movementX:n});let i=t.shiftKey?1:.5;if(t.altKey&&(i/=4),this.directions.y){const t=s*-i;this.addVelocity(0,t)}if(this.directions.x){const t=n*-i;this.addVelocity(t,0)}},onUp:()=>{this.container.classList.remove("Scrolling"),document.exitPointerLock(),this.pointerDown=!1}})}_checkPathForMomentumScroll(t){const e=t.composedPath();for(let t=0;t<e.length;t++){const s=e[t];if(s===this.container)break;if(s._momentumScroll)return!0}return!1}__animate__(){!this.animating&&(this.animating=!0)&&requestAnimationFrame(this.__frame__.bind(this))}__framedelta__(){const t=performance.now();if(null===this.lastFramePerf)return this.lastFramePerf=t,0;const e=t-this.lastFramePerf;return this.lastFramePerf=t,e/this.tick_length}__frame__(){const t=this.__framedelta__();if(0===t)return void(this.animating&&requestAnimationFrame(this.__frame__.bind(this)));const e=this.pointerDown?.95*this.friction:this.friction,s=Math.pow(e,t);let n=0,i=0,o=0,r=0;this.directions.y&&(this.velocityY*=s,r=Math.abs(this.velocityY),i=this.velocityY*t,this.scrollTarget.scrollTop+=i),this.directions.x&&(this.velocityX*=s,o=Math.abs(this.velocityX),n=this.velocityX*t,this.scrollTarget.scrollLeft+=n),this.onScroll?.({deltaX:n,deltaY:i});const a=!this.directions.y||r<this.minVelocityY;if((!this.directions.x||o<this.minVelocityX)&&a)return this.lastFramePerf=null,this.animating=!1,void this.onScroll?.({deltaX:0,deltaY:0});this.animating&&requestAnimationFrame(this.__frame__.bind(this))}checkCounterScroll(t){this.directions.y&&(t.deltaY>0&&this.velocityY<0||t.deltaY<0&&this.velocityY>0)&&(this.velocityY/=10),this.directions.x&&(t.deltaX>0&&this.velocityX<0||t.deltaX<0&&this.velocityX>0)&&(this.velocityX/=10)}resetVelocity(){this.directions.y&&(this.velocityY/=10),this.directions.x&&(this.velocityX/=10),this.__animate__()}slowStop(){console.log("> slowStop",this.velocityY,this.velocityX),this.velocityY/=4,this.velocityX/=4,console.log("slowStop >",this.velocityY,this.velocityX)}addVelocity(t=0,e=0){this.directions.y&&0!==e&&((e>0&&this.velocityY<0||e<0&&this.velocityY>0)&&(this.velocityY/=10),this.velocityY=Math.max(-this.maxVelocityY,Math.min(this.velocityY+e,this.maxVelocityY))),this.directions.x&&0!==t&&((t>0&&this.velocityX<0||t<0&&this.velocityX>0)&&(this.velocityX/=10),this.velocityX=Math.max(-this.maxVelocityX,Math.min(this.velocityX+t,this.maxVelocityX))),this.__animate__()}wheel(t){if(this._checkPathForMomentumScroll(t))return;t.preventDefault(),t.stopPropagation(),this.checkCounterScroll(t);let e=t.deltaX,s=t.deltaY;this.swapY&&(e=t.deltaY),this.swapX&&(s=t.deltaX),this.direction=s>0?"down":"up";let n=0,i=0;this.directions.y&&0!==s?Math.abs(s)<this.smallDeltaStep.floor?(this.smallDeltaStep.culm+=s,Math.abs(this.smallDeltaStep.culm)>this.smallDeltaStep.culmLimit&&(i=this.smallDeltaStep.tick*(s>0?1:-1),this.smallDeltaStep.culm=0)):(i=.1*s,this.smallDeltaStep.culm=0):this.smallDeltaStep.culm=0,this.directions.x&&0!==e?Math.abs(e)<this.smallDeltaStepX.floor?(this.smallDeltaStepX.culm+=e,Math.abs(this.smallDeltaStepX.culm)>this.smallDeltaStepX.culmLimit&&(n=this.smallDeltaStepX.tick*(e>0?1:-1),this.smallDeltaStepX.culm=0)):(n=.1*e,this.smallDeltaStepX.culm=0):this.smallDeltaStepX.culm=0,0===n&&0===i||this.addVelocity(n,i)}}class se{constructor(t){this.input_binder=t,this.tapsToExit=3,this.backPresses=this.tapsToExit,this.onBack=[],window.history.pushState({},""),window.addEventListener("popstate",()=>this.handleBackButton()),this._createTapIndicator()}_createTapIndicator(){N`
    <div this="tap_indicator" class="tap-to-exit-confirm">
        <div class="tap-to-exit-label" this="nth">Go back ${this.tapsToExit} more times to exit app.</div>
    </div>
`.bind(this)}handleBackButton(){const t=this.onBack.sort((t,e)=>t.weight>e.weight?1:-1);this.onBack=this.onBack.filter(t=>t.cb.deref());for(const e of t){const t=e.cb.deref();if(t&&t())return void window.history.pushState({},"")}this.backPresses<3&&window.navigator.vibrate?.(300),Ls(this).delay("back-panic",700,()=>{this.backPresses=this.tapsToExit,window.history.pushState({},""),this.tap_indicator?.classList.remove("visible")}),this.tap_indicator?.classList.add("visible");const e=Math.max(1,this.backPresses);var s;if(this.nth.textContent=`Go back ${e} more time${s=e,s>1?"s":""} to exit app.`,this.backPresses--,this.backPresses<=0)return Ms(),window.history.back();window.history.pushState({},"")}on(t,e={}){"function"==typeof t?this.onBack.push({cb:new WeakRef(t),weight:0,...e}):console.warn("[ZyXInput] Invalid callback for BackHandler.on()")}}class ne{constructor({customQueryFunc:t,customClearSelections:e,onKeyPress:s=null}={}){this.onKeyPress=s,this.customQueryFunc=t,this.customClearSelections=e,this.enabledDefaults=["Tab","Esc","F5","F11","F12","KeyI","KeyC","KeyV","KeyX"],this._initializeEventListeners(),this.mouse={x:0,y:0,pointerDown:!1},this.activeEvents=new b,this.openModals=new b,this.listenToController=!1,this.clickOrTwoWindowMs=250,this.moveTripperDist=10,this.mobilePressHoldDelay=550,this.backHandler=new se(this),this.backHandler.on(t=>this.processModalEvent(),{weight:1e3})}_initializeEventListeners(){document.addEventListener("keypress",t=>this.keyEvent("keypress",t)),document.addEventListener("keydown",t=>this.keyEvent("keydown",t)),document.addEventListener("keyup",t=>this.keyEvent("keyup",t)),document.addEventListener("pointermove",t=>this._updateMousePosition(t)),document.addEventListener("pointerdown",t=>this._updateMousePosition(t,!0)),document.addEventListener("pointerup",t=>this.mouse.pointerDown=!1),document.addEventListener("pointerleave",t=>this.mouse.pointerDown=!1),document.addEventListener("contextmenu",t=>{if(t.shiftKey||Xt(t,"[can-contextmenu]"))return!1;!function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault()}(t)}),this.on(document).dragstart(t=>{})}_updateMousePosition(t,e=!1){this.mouse.x=t.clientX,this.mouse.y=t.clientY,e&&(this.mouse.pointerDown=!0)}on(t){return new Proxy(s,{get:(e,s)=>this.customEventHandlers(t,s)})}customEventHandlers(t,e){if(s[e])return(...n)=>s[e].bind(this)(t,...n);switch(e){case"pointerdown":case"pointerup":case"dragstart":return s=>{t.addEventListener(e,t=>{const n=this.beforePointerEvent(e,t);s(t,n)})};default:throw new Error(`Event function ${e}(elem, ...args) not found in ZyXInput.presets`)}}bindMomentumScroll(t,e){return new ee(this,t,e)}queryApplication(t){return this?.customQueryFunc?.(t)||document.querySelectorAll(t)}clearAllSelections(){this?.customClearSelections?.()||window.getSelection().removeAllRanges()}nullAllEvents(){this.activeEvents.clear()}kingOfTheStack(t,e){for(const e of this.activeEvents.get())e!==t&&e.setFalse();e?.(),this.nullAllEvents()}beforePointerEvent(t,e){switch(t){case"pointerDownMoveUp":case"pointerdown":case"dragstart":case"custom-click":case"clickone":case"clickortwo":if(this.processModalEvent(e))return!1;default:return!0}}processModalEvent(t){const e=this.openModals.get();return e.length<0||e.length>0&&(!t||!Xt(t,"[is-modal]"))&&(e.forEach(t=>t.clickedOutside(t)),this.nullAllEvents(),t?.stopPropagation(),t?.stopImmediatePropagation(),this.openModals.clear(),!0)}isolateEventWithinContainer(t,e){return this.openModals.add(t),t.setAttribute("is-modal",""),t.clickedOutside=e.bind(t),e}unisolateEventWithinContainer(t){this.openModals.delete(t),t.removeAttribute("is-modal")}moveTripper({startX:t,startY:e,deadzone:s}={}){const{moveFuse:n,check:i}=this.deadzone({startX:t,startY:e,deadzone:s});return document.addEventListener("pointermove",i),document.addEventListener("pointerup",()=>document.removeEventListener("pointermove",i),{once:!0}),{moveFuse:n,check:i}}deadzone({startX:t,startY:e,deadzone:s=this.moveTripperDist,moveFuse:n=new ie}={}){return{moveFuse:n,check:i=>(Math.hypot(i.clientX-t,i.clientY-e)>s&&n.setTrue(),n.true)}}async keyEvent(t,e){try{if(!("key"in e))return;if(e.ctrlKey||e.metaKey||this.queryApplication("input:focus,textarea:focus").length>0)return!1;e.joy||this.enabledDefaults.includes(e.code)||(e.preventDefault(),e.stopPropagation()),this?.onKeyPress?.(t,e)}catch(s){throw console.error("[Key Event Error]",{event:t,e,error:s}),s}}socketXinputEvent(t){if(!this.listenToController)return;const e=1===t.pressed?"keydown":"keyup";this.keyEvent(e,{joy:!0,key:oe[t.button]})}}class ie{constructor(t=!1){this.true=t,this.false=!t}reset(t){return this.true=!1,this.false=!0,"function"==typeof t&&t(),this}falseTrue(t,e,...s){return this.true?e(...s):t(...s),this}setTrue(){return this.true=!0,this.false=!1,this}setFalse(){return this.true=!1,this.false=!0,this}}const oe={1:"x-uppad",2:"x-downpad",3:"x-leftpad",4:"x-rightpad",5:"x-menu",6:"x-start",7:"x-rightjoy",8:"x-leftjoy",9:"x-leftbumper",10:"x-rightbumper",13:"x-A",14:"x-X",15:"x-B",16:"x-Y"},re=Object.create(null);re.open="0",re.close="1",re.ping="2",re.pong="3",re.message="4",re.upgrade="5",re.noop="6";const ae=Object.create(null);Object.keys(re).forEach(t=>{ae[re[t]]=t});const ce={type:"error",data:"parser error"},he="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),le="function"==typeof ArrayBuffer,ue=({type:t,data:e},s,n)=>{return he&&e instanceof Blob?s?n(e):de(e,n):le&&(e instanceof ArrayBuffer||(i=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer))?s?n(e):de(new Blob([e]),n):n(re[t]+(e||""));var i},de=(t,e)=>{const s=new FileReader;return s.onload=function(){const t=s.result.split(",")[1];e("b"+t)},s.readAsDataURL(t)},pe="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<64;t++)pe["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;const fe="function"==typeof ArrayBuffer,me=(t,e)=>{if("string"!=typeof t)return{type:"message",data:ge(t,e)};const s=t.charAt(0);return"b"===s?{type:"message",data:ye(t.substring(1),e)}:ae[s]?t.length>1?{type:ae[s],data:t.substring(1)}:{type:ae[s]}:ce},ye=(t,e)=>{if(fe){const s=(t=>{let e,s,n,i,o,r=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);const h=new ArrayBuffer(r),l=new Uint8Array(h);for(e=0;e<a;e+=4)s=pe[t.charCodeAt(e)],n=pe[t.charCodeAt(e+1)],i=pe[t.charCodeAt(e+2)],o=pe[t.charCodeAt(e+3)],l[c++]=s<<2|n>>4,l[c++]=(15&n)<<4|i>>2,l[c++]=(3&i)<<6|63&o;return h})(t);return ge(s,e)}return{base64:!0,data:t}},ge=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t,ve=String.fromCharCode(30);function be(t){if(t)return function(t){for(var e in be.prototype)t[e]=be.prototype[e];return t}(t)}be.prototype.on=be.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},be.prototype.once=function(t,e){function s(){this.off(t,s),e.apply(this,arguments)}return s.fn=e,this.on(t,s),this},be.prototype.off=be.prototype.removeListener=be.prototype.removeAllListeners=be.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var s,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<n.length;i++)if((s=n[i])===e||s.fn===e){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},be.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),s=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(s){n=0;for(var i=(s=s.slice(0)).length;n<i;++n)s[n].apply(this,e)}return this},be.prototype.emitReserved=be.prototype.emit,be.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},be.prototype.hasListeners=function(t){return!!this.listeners(t).length};const we="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function ke(t,...e){return e.reduce((e,s)=>(t.hasOwnProperty(s)&&(e[s]=t[s]),e),{})}const Ee=setTimeout,Te=clearTimeout;function xe(t,e){e.useNativeTimers?(t.setTimeoutFn=Ee.bind(we),t.clearTimeoutFn=Te.bind(we)):(t.setTimeoutFn=setTimeout.bind(we),t.clearTimeoutFn=clearTimeout.bind(we))}class Ae extends Error{constructor(t,e,s){super(t),this.description=e,this.context=s,this.type="TransportError"}}class _e extends be{constructor(t){super(),this.writable=!1,xe(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,s){return super.emitReserved("error",new Ae(t,e,s)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=me(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const Me="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Se={};let Le,Ce=0,Pe=0;function Oe(t){let e="";do{e=Me[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function Re(){const t=Oe(+new Date);return t!==Le?(Ce=0,Le=t):t+"."+Oe(Ce++)}for(;Pe<64;Pe++)Se[Me[Pe]]=Pe;function De(t){let e="";for(let s in t)t.hasOwnProperty(s)&&(e.length&&(e+="&"),e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return e}let Be=!1;try{Be="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(re){}const Ne=Be;function Fe(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||Ne))return new XMLHttpRequest}catch(t){}if(!e)try{return new(we[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function Ie(){}const Xe=null!=new Fe({xdomain:!1}).responseType;class je extends be{constructor(t,e){super(),xe(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=ke(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new Fe(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof e.status?e.status:0)},0))},e.send(this.data)}catch(t){return void this.setTimeoutFn(()=>{this.onError(t)},0)}"undefined"!=typeof document&&(this.index=je.requestsCount++,je.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=Ie,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete je.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}function qe(){for(let t in je.requests)je.requests.hasOwnProperty(t)&&je.requests[t].abort()}je.requestsCount=0,je.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",qe):"function"==typeof addEventListener&&addEventListener("onpagehide"in we?"pagehide":"unload",qe,!1));const ze="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),Ye=we.WebSocket||we.MozWebSocket,Ue="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),He={websocket:class extends _e{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,s=Ue?{}:ke(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=Ue?new Ye(t,e,s):e?new Ye(t,e):new Ye(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const s=t[e],n=e===t.length-1;ue(s,this.supportsBinary,t=>{try{this.ws.send(t)}catch(t){}n&&ze(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let s="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(s=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Re()),this.supportsBinary||(t.b64=1);const n=De(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+s+this.opts.path+(n.length?"?"+n:"")}check(){return!!Ye}},polling:class extends _e{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const e="https:"===location.protocol;let s=location.port;s||(s=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||s!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=Xe&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",function(){--t||e()})),this.writable||(t++,this.once("drain",function(){--t||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const s=t.split(ve),n=[];for(let t=0;t<s.length;t++){const i=me(s[t],e);if(n.push(i),"error"===i.type)break}return n})(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const s=t.length,n=new Array(s);let i=0;t.forEach((t,o)=>{ue(t,!1,t=>{n[o]=t,++i===s&&e(n.join(ve))})})})(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let s="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Re()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(s=":"+this.opts.port);const n=De(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+s+this.opts.path+(n.length?"?"+n:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new je(this.uri(),t)}doWrite(t,e){const s=this.request({method:"POST",data:t});s.on("success",e),s.on("error",(t,e)=>{this.onError("xhr post error",t,e)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,e)=>{this.onError("xhr poll error",t,e)}),this.pollXhr=t}}},Ve=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,$e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function We(t){const e=t,s=t.indexOf("["),n=t.indexOf("]");-1!=s&&-1!=n&&(t=t.substring(0,s)+t.substring(s,n).replace(/:/g,";")+t.substring(n,t.length));let i=Ve.exec(t||""),o={},r=14;for(;r--;)o[$e[r]]=i[r]||"";return-1!=s&&-1!=n&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(t,e){const s=e.replace(/\/{2,9}/g,"/").split("/");return"/"!=e.slice(0,1)&&0!==e.length||s.splice(0,1),"/"==e.slice(-1)&&s.splice(s.length-1,1),s}(0,o.path),o.queryKey=function(t,e){const s={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,n){e&&(s[e]=n)}),s}(0,o.query),o}class Ke extends be{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=We(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=We(e.host).host),xe(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},s=t.split("&");for(let t=0,n=s.length;t<n;t++){let n=s[t].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const s=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new He[t](s)}open(){let t;if(this.opts.rememberUpgrade&&Ke.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(t){let e=this.createTransport(t),s=!1;Ke.priorWebsocketSuccess=!1;const n=()=>{s||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!s)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Ke.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{s||"closed"!==this.readyState&&(h(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function i(){s||(s=!0,h(),e.close(),e=null)}const o=t=>{const s=new Error("probe error: "+t);s.transport=e.name,i(),this.emitReserved("upgradeError",s)};function r(){o("transport closed")}function a(){o("socket closed")}function c(t){e&&t.name!==e.name&&i()}const h=()=>{e.removeListener("open",n),e.removeListener("error",o),e.removeListener("close",r),this.off("close",a),this.off("upgrading",c)};e.once("open",n),e.once("error",o),e.once("close",r),this.once("close",a),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",Ke.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(t+="string"==typeof(e=n)?function(t){let e=0,s=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?s+=1:e<2048?s+=2:e<55296||e>=57344?s+=3:(n++,s+=4);return s}(e):Math.ceil(1.33*(e.byteLength||e.size))),s>0&&t>this.maxPayload)return this.writeBuffer.slice(0,s);t+=2}var e;return this.writeBuffer}write(t,e,s){return this.sendPacket("message",t,e,s),this}send(t,e,s){return this.sendPacket("message",t,e,s),this}sendPacket(t,e,s,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof s&&(n=s,s=null),"closing"===this.readyState||"closed"===this.readyState)return;(s=s||{}).compress=!1!==s.compress;const i={type:t,data:e,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},s=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}onError(t){Ke.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let s=0;const n=t.length;for(;s<n;s++)~this.transports.indexOf(t[s])&&e.push(t[s]);return e}}Ke.protocol=4;const Ze="function"==typeof ArrayBuffer,Je=Object.prototype.toString,Qe="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Je.call(Blob),Ge="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Je.call(File);function ts(t){return Ze&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||Qe&&t instanceof Blob||Ge&&t instanceof File}function es(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)if(es(t[e]))return!0;return!1}if(ts(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return es(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&es(t[e]))return!0;return!1}function ss(t){const e=[],s=t.data,n=t;return n.data=ns(s,e),n.attachments=e.length,{packet:n,buffers:e}}function ns(t,e){if(!t)return t;if(ts(t)){const s={_placeholder:!0,num:e.length};return e.push(t),s}if(Array.isArray(t)){const s=new Array(t.length);for(let n=0;n<t.length;n++)s[n]=ns(t[n],e);return s}if("object"==typeof t&&!(t instanceof Date)){const s={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=ns(t[n],e));return s}return t}function is(t,e){return t.data=os(t.data,e),t.attachments=void 0,t}function os(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=os(t[s],e);else if("object"==typeof t)for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=os(t[s],e));return t}var rs;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(rs||(rs={}));class as extends be{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===rs.BINARY_EVENT||e.type===rs.BINARY_ACK?(this.reconstructor=new cs(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!ts(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const s={type:Number(t.charAt(0))};if(void 0===rs[s.type])throw new Error("unknown packet type "+s.type);if(s.type===rs.BINARY_EVENT||s.type===rs.BINARY_ACK){const n=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const i=t.substring(n,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");s.attachments=Number(i)}if("/"===t.charAt(e+1)){const n=e+1;for(;++e&&","!==t.charAt(e)&&e!==t.length;);s.nsp=t.substring(n,e)}else s.nsp="/";const n=t.charAt(e+1);if(""!==n&&Number(n)==n){const n=e+1;for(;++e;){const s=t.charAt(e);if(null==s||Number(s)!=s){--e;break}if(e===t.length)break}s.id=Number(t.substring(n,e+1))}if(t.charAt(++e)){const n=this.tryParse(t.substr(e));if(!as.isPayloadValid(s.type,n))throw new Error("invalid payload");s.data=n}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case rs.CONNECT:return"object"==typeof e;case rs.DISCONNECT:return void 0===e;case rs.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case rs.EVENT:case rs.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case rs.ACK:case rs.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class cs{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=is(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var hs=Object.freeze({__proto__:null,protocol:5,get PacketType(){return rs},Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==rs.EVENT&&t.type!==rs.ACK||!es(t)?[this.encodeAsString(t)]:(t.type=t.type===rs.EVENT?rs.BINARY_EVENT:rs.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==rs.BINARY_EVENT&&t.type!==rs.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=ss(t),s=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(s),n}},Decoder:as});function ls(t,e,s){return t.on(e,s),function(){t.off(e,s)}}const us=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ds extends be{constructor(t,e,s){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,s&&s.auth&&(this.auth=s.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[ls(t,"open",this.onopen.bind(this)),ls(t,"packet",this.onpacket.bind(this)),ls(t,"error",this.onerror.bind(this)),ls(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(us.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');e.unshift(t);const s={type:rs.EVENT,data:e,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,n=e.pop();this._registerAckCallback(t,n),s.id=t}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,e){const s=this.flags.timeout;if(void 0===s)return void(this.acks[t]=e);const n=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))},s);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(n),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:rs.CONNECT,data:t})}):this.packet({type:rs.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case rs.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case rs.EVENT:case rs.BINARY_EVENT:this.onevent(t);break;case rs.ACK:case rs.BINARY_ACK:this.onack(t);break;case rs.DISCONNECT:this.ondisconnect();break;case rs.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const s of e)s.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let s=!1;return function(...n){s||(s=!0,e.packet({type:rs.ACK,id:t,data:n}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:rs.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let s=0;s<e.length;s++)if(t===e[s])return e.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const s of e)s.apply(this,t.data)}}}function ps(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ps.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),s=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+s:t-s}return 0|Math.min(t,this.max)},ps.prototype.reset=function(){this.attempts=0},ps.prototype.setMin=function(t){this.ms=t},ps.prototype.setMax=function(t){this.max=t},ps.prototype.setJitter=function(t){this.jitter=t};class fs extends be{constructor(t,e){var s;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,xe(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(s=e.randomizationFactor)&&void 0!==s?s:.5),this.backoff=new ps({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const n=e.parser||hs;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ke(this.uri,this.opts);const e=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=ls(e,"open",function(){s.onopen(),t&&t()}),i=ls(e,"error",e=>{s.cleanup(),s._readyState="closed",this.emitReserved("error",e),t?t(e):s.maybeReconnectOnOpen()});if(!1!==this._timeout){const t=this._timeout;0===t&&n();const s=this.setTimeoutFn(()=>{n(),e.close(),e.emit("error",new Error("timeout"))},t);this.opts.autoUnref&&s.unref(),this.subs.push(function(){clearTimeout(s)})}return this.subs.push(n),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(ls(t,"ping",this.onping.bind(this)),ls(t,"data",this.ondata.bind(this)),ls(t,"error",this.onerror.bind(this)),ls(t,"close",this.onclose.bind(this)),ls(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){ze(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let s=this.nsps[t];return s||(s=new ds(this,t,e),this.nsps[t]=s),s}_destroy(t){const e=Object.keys(this.nsps);for(const t of e)if(this.nsps[t].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let s=0;s<e.length;s++)this.engine.write(e[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&s.unref(),this.subs.push(function(){clearTimeout(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const ms={};function ys(t,e){"object"==typeof t&&(e=t,t=void 0);const s=function(t,e="",s){let n=t;s=s||"undefined"!=typeof location&&location,null==t&&(t=s.protocol+"//"+s.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?s.protocol+t:s.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==s?s.protocol+"//"+t:"https://"+t),n=We(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+e,n.href=n.protocol+"://"+i+(s&&s.port===n.port?"":":"+n.port),n}(t,(e=e||{}).path||"/socket.io"),n=s.source,i=s.id,o=s.path,r=ms[i]&&o in ms[i].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||r?a=new fs(n,e):(ms[i]||(ms[i]=new fs(n,e)),a=ms[i]),s.query&&!e.query&&(e.query=s.queryKey),a.socket(s.path,e)}Object.assign(ys,{Manager:fs,Socket:ds,io:ys,connect:ys});class gs{constructor({endpointUrl:t,events:e={},autoConnect:s=!0,debug:n=!1,socketOptions:i={}}={}){if(!t)throw new Error("endpointUrl is required");this.endpointUrl=t,this.debug=n,this.socketOptions={reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,...i},this.sio=ys(this.endpointUrl,this.socketOptions),this.extendedEvents={},this.rooms=new Set,this.setupConnectionHandlers(),this.bind(e),s&&this.connect()}setupConnectionHandlers(){this.sio.on("connect",()=>{this.debug&&console.log("[socketio] Connected to server"),this.connected()}),this.sio.on("disconnect",t=>{this.debug&&console.log("[socketio] Disconnected from server:",t),this.extendedEvents.disconnected&&this.extendedEvents.disconnected(t)}),this.sio.on("connect_error",t=>{this.debug&&console.error("[socketio] Connection error:",t),this.extendedEvents.error&&this.extendedEvents.error(t)})}connect(){this.sio.connected||this.sio.connect()}disconnect(){this.sio.disconnect()}connected(){this.extendedEvents.connected&&this.extendedEvents.connected()}join(t){if(!t)throw new Error("roomCode is required");this.debug&&console.log("[socketio] Joining room:",t),this.sio.emit("enter",{room_code:t}),this.rooms.add(t),this.extendedEvents.roomJoined&&this.extendedEvents.roomJoined(t)}leave(t){if(!t)throw new Error("roomCode is required");this.debug&&console.log("[socketio] Leaving room:",t),this.sio.emit("leave",{room_code:t}),this.rooms.delete(t),this.extendedEvents.roomLeft&&this.extendedEvents.roomLeft(t)}getRooms(){return Array.from(this.rooms)}emit(t,e={}){if(!t)throw new Error("event name is required");this.debug&&console.log("[socketio] Emitting event:",t,e),this.sio.emit(t,e)}bind(t){if(!t||"object"!=typeof t)throw new Error("nameCallbacks must be an object");for(const[e,s]of Object.entries(t)){if("function"!=typeof s)throw new Error(`Callback for event "${e}" must be a function`);["connected","disconnected","error","roomJoined","roomLeft"].includes(e)?this.extendedEvents[e]=s:this.sio.on(e,s)}}removeAllListeners(){this.sio.removeAllListeners(),this.extendedEvents={},this.rooms.clear()}isConnected(){return this.sio.connected}}function vs(t,e,s,n,i){const o=s=>{s.animationName===e&&("none"===n&&(t.style.display=n),t.removeEventListener("animationend",o),i&&i())};"none"!==n&&(t.style.display=n),t.style.animation=`${e} ${s}`,t.addEventListener("animationend",o)}async function bs(t,{top:e,left:s}={}){if(!ws.has(t)){const n=new ks(t,e,s);return ws.set(t,n),new Promise(t=>{n.onend=t,n.start()})}ws.get(t).update_target({top:e,left:s})}const ws=new WeakMap;class ks{constructor(t,e,s){this.container=t,this.target={top:e,left:s},this.startContext={startTop:t.scrollTop,startLeft:t.scrollLeft},this.startTime=performance.now(),this.onend=null,this.duration=200}update_target({top:t,left:e}){void 0!==t&&(this.target.top=t),void 0!==e&&(this.target.left=e),this.startContext={startTop:this.container.scrollTop,startLeft:this.container.scrollLeft},this.startTime=performance.now()}frame(){const t=performance.now()-this.startTime,{top:e,left:s}=this.target,{startTop:n,startLeft:i}=this.startContext,o="easeInOutQuad",r=e??this.container.scrollTop,a=s??this.container.scrollLeft;t<this.duration?(void 0!==e&&(this.container.scrollTop=Es[o](t,n,r-n,this.duration)),void 0!==s&&(this.container.scrollLeft=Es[o](t,i,a-i,this.duration)),requestAnimationFrame(this.frame.bind(this))):(void 0!==e&&(this.container.scrollTop=r),void 0!==s&&(this.container.scrollLeft=a),ws.delete(this.container),this.onend&&this.onend())}start(){requestAnimationFrame(this.frame.bind(this))}}const Es={easeInOutQuad:(t,e,s,n)=>(t/=n/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e,easeInQuad:(t,e,s,n)=>s*((t/=n)*t)+e,easeOutQuad:(t,e,s,n)=>-s*(t/=n)*(t-2)+e,easeBounce:(t,e,s,n)=>(t/=n)<1/2.75?s*(7.5625*t*t)+e:t<2/2.75?s*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?s*(7.5625*(t-=2.25/2.75)*t+.9375)+e:s*(7.5625*(t-=2.625/2.75)*t+.984375)+e},Ts=document.createElement("canvas");Ts.width=500,Ts.height=500;const xs=200,As=Ts.getContext("2d",{willReadFrequently:!0});function _s(t,e=!0){return new Promise((s,n)=>{const i=new Image;e&&(i.crossOrigin="Anonymous");let o,r,a=-4,c={r:0,g:0,b:0},h=0;i.src=t,i.onload=()=>{if(As.drawImage(i,0,0,500,500),!As)return s();try{o=As.getImageData(0,0,500,500)}catch(t){return console.log("error",t),s()}for(r=o.data.length;(a+=120)<r;)++h,c.r+=o.data[a],c.g+=o.data[a+1],c.b+=o.data[a+2];i.remove(),c.r=~~(c.r/h),c.g=~~(c.g/h),c.b=~~(c.b/h);const t=c.r/=255,e=c.g/=255,n=c.b/=255,l=Math.min(t,e,n),u=Math.max(t,e,n),d=u-l;let p=0,f=0,m=0;p=0==d?0:u==t?(e-n)/d%6:u==e?(n-t)/d+2:(t-e)/d+4,p=Math.round(60*p),p<0&&(p+=360),m=(u+l)/2,f=0==d?0:d/(1-Math.abs(2*m-1)),f=(100*f).toFixed(1),m=(100*m).toFixed(1),f<3&&(p=xs),s({h:p,s:f,l:m})}})}function Ms(){return navigator.maxTouchPoints>0}const Ss={forQuery:Bt,setProps:Nt,delay:lt,instant:dt,clearDelay:ut,delayChain:ct,breakDelayChain:ht,debounce:pt,addEventListeners:mt,removeEventListeners:yt};function Ls(t){return new Proxy(Ss,{get:(e,s)=>{if(e.hasOwnProperty(s)){const n=e[s];return(...e)=>n(t,...e)}throw new Error(`zyX().${s} is not a function`)}})}return G`
ph {
display: none;
}
`,e})());